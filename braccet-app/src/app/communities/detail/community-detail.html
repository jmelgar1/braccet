<div class="min-h-[calc(100vh-4rem)] bg-gray-100 p-6">
  <div class="w-3/4 mx-auto">
    <!-- Loading state -->
    @if (loading()) {
      <div class="text-center py-8">
        <p class="text-gray-500">Loading community...</p>
      </div>
    }

    <!-- Error state -->
    @if (error()) {
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
        {{ error() }}
      </div>
    }

    @if (!loading() && community()) {
      <!-- Header -->
      <div class="flex justify-between items-start mb-6">
        <div>
          <div class="flex items-center gap-3">
            <h1 class="text-2xl font-bold text-gray-900">{{ community()!.name }}</h1>
            @if (community()!.game) {
              <span class="px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700">
                {{ community()!.game }}
              </span>
            }
          </div>
          @if (community()!.description) {
            <p class="text-gray-600 mt-2">{{ community()!.description }}</p>
          }
          <p class="text-sm text-gray-400 mt-2">
            Created {{ community()!.created_at | date:'mediumDate' }}
          </p>
        </div>
        <a routerLink="/communities" class="text-blue-600 hover:text-blue-800 text-sm">
          &larr; Back to Communities
        </a>
      </div>

      <!-- Tabs -->
      <div class="border-b border-gray-200 mb-6">
        <nav class="flex gap-8">
          <button
            (click)="setActiveTab('members')"
            [class]="activeTab() === 'members'
              ? 'border-b-2 border-blue-500 text-blue-600 pb-3 font-medium'
              : 'text-gray-500 hover:text-gray-700 pb-3'">
            Members ({{ members().length }})
          </button>
          <button
            (click)="setActiveTab('tournaments')"
            [class]="activeTab() === 'tournaments'
              ? 'border-b-2 border-blue-500 text-blue-600 pb-3 font-medium'
              : 'text-gray-500 hover:text-gray-700 pb-3'">
            Tournaments ({{ tournaments().length }})
          </button>
          <button
            (click)="setActiveTab('leaderboards')"
            [class]="activeTab() === 'leaderboards'
              ? 'border-b-2 border-blue-500 text-blue-600 pb-3 font-medium'
              : 'text-gray-500 hover:text-gray-700 pb-3'">
            Leaderboards
          </button>
          @if (isOwnerOrAdmin()) {
            <button
              (click)="setActiveTab('elo')"
              [class]="activeTab() === 'elo'
                ? 'border-b-2 border-blue-500 text-blue-600 pb-3 font-medium'
                : 'text-gray-500 hover:text-gray-700 pb-3'">
              ELO Settings
            </button>
          }
        </nav>
      </div>

      <!-- Members Tab -->
      @if (activeTab() === 'members') {
        <div class="bg-white rounded-lg shadow">
          <!-- Add Member Button -->
          @if (isOwnerOrAdmin()) {
            <div class="p-4 border-b border-gray-200">
              <button
                (click)="toggleAddMemberForm()"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg transition-colors">
                {{ showAddMemberForm() ? 'Cancel' : 'Add Member' }}
              </button>
            </div>
          }

          <!-- Add Member Form -->
          @if (showAddMemberForm()) {
            <div class="p-4 border-b border-gray-200 bg-gray-50">
              @if (addMemberError()) {
                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                  {{ addMemberError() }}
                </div>
              }

              <form (ngSubmit)="onAddMember()" class="flex gap-4 items-end">
                <div class="flex-1">
                  <label for="displayName" class="block text-sm font-medium text-gray-700 mb-1">Display Name *</label>
                  <input
                    type="text"
                    id="displayName"
                    [(ngModel)]="newMember.display_name"
                    name="displayName"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="Member display name"
                    [disabled]="addingMember()">
                </div>
                <button
                  type="submit"
                  class="bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg transition-colors disabled:opacity-50"
                  [disabled]="addingMember()">
                  {{ addingMember() ? 'Adding...' : 'Add' }}
                </button>
              </form>
            </div>
          }

          <!-- Members List -->
          @if (members().length === 0) {
            <div class="p-8 text-center">
              <p class="text-gray-500">No members yet</p>
            </div>
          } @else {
            <ul class="divide-y divide-gray-200">
              @for (member of members(); track member.id) {
                <li class="p-4 flex justify-between items-center hover:bg-gray-50">
                  <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-medium">
                      {{ member.display_name.charAt(0).toUpperCase() }}
                    </div>
                    <div>
                      <div class="flex items-center gap-2">
                        <span class="font-medium text-gray-900">{{ member.display_name }}</span>
                        <span [class]="'px-2 py-0.5 rounded-full text-xs font-medium ' + getRoleBadgeClass(member.role)">
                          {{ member.role }}
                        </span>
                        @if (member.is_ghost) {
                          <span class="px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-500">
                            ghost
                          </span>
                        }
                      </div>
                      <div class="text-sm text-gray-500">
                        {{ member.matches_won }}/{{ member.matches_played }} wins
                        @if (member.elo_rating) {
                          <span class="ml-2">ELO: {{ member.elo_rating }}</span>
                        }
                      </div>
                    </div>
                  </div>
                  <div class="flex items-center gap-2">
                    @if (isOwner() && member.role !== 'owner') {
                      <select
                        [value]="member.role"
                        (change)="updateMemberRole(member.id, $any($event.target).value)"
                        class="text-sm border border-gray-300 rounded px-2 py-1">
                        <option value="member">Member</option>
                        <option value="admin">Admin</option>
                      </select>
                    }
                    @if (isOwnerOrAdmin() && member.role !== 'owner') {
                      <button
                        (click)="removeMember(member.id, member.display_name, $event)"
                        class="text-red-500 hover:text-red-700 text-sm font-medium">
                        Remove
                      </button>
                    }
                  </div>
                </li>
              }
            </ul>
          }
        </div>
      }

      <!-- Tournaments Tab -->
      @if (activeTab() === 'tournaments') {
        <div class="space-y-4">
          @if (tournaments().length === 0) {
            <div class="bg-white rounded-lg shadow p-8 text-center">
              <p class="text-gray-500 mb-4">No tournaments yet</p>
              <p class="text-gray-400 text-sm">Create a tournament and assign it to this community</p>
            </div>
          } @else {
            @for (tournament of tournaments(); track tournament.id) {
              <div
                class="bg-white rounded-lg shadow p-4 hover:shadow-md transition-shadow cursor-pointer"
                (click)="onTournamentClick(tournament.slug)">
                <div class="flex justify-between items-start">
                  <div>
                    <div class="flex items-center gap-2">
                      <h3 class="text-lg font-semibold text-gray-900">{{ tournament.name }}</h3>
                      <span [class]="'px-2 py-0.5 rounded-full text-xs font-medium ' + getStatusBadgeClass(tournament.status)">
                        {{ tournament.status }}
                      </span>
                    </div>
                    @if (tournament.description) {
                      <p class="text-gray-600 text-sm mt-1">{{ tournament.description }}</p>
                    }
                    <div class="flex gap-4 mt-2 text-sm text-gray-500">
                      @if (tournament.game) {
                        <span>{{ tournament.game }}</span>
                      }
                      <span>{{ tournament.format }}</span>
                    </div>
                  </div>
                  <span class="text-sm text-gray-400">
                    {{ tournament.created_at | date:'mediumDate' }}
                  </span>
                </div>
              </div>
            }
          }
        </div>
      }

      <!-- Leaderboards Tab -->
      @if (activeTab() === 'leaderboards') {
        <div class="space-y-4">
          @if (loadingElo()) {
            <div class="bg-white rounded-lg shadow p-8 text-center">
              <p class="text-gray-500">Loading leaderboards...</p>
            </div>
          } @else if (eloSystems().length === 0) {
            <div class="bg-white rounded-lg shadow p-8 text-center">
              <p class="text-gray-500 mb-2">No rating systems configured</p>
              <p class="text-gray-400 text-sm">Leaderboards will appear once rating systems are created</p>
            </div>
          } @else {
            <!-- System tabs -->
            <div class="bg-white rounded-lg shadow">
              <div class="border-b border-gray-200">
                <nav class="flex overflow-x-auto">
                  @for (system of eloSystems(); track system.id) {
                    <button
                      (click)="selectEloSystem(system)"
                      [class]="selectedEloSystem()?.id === system.id
                        ? 'border-b-2 border-blue-500 text-blue-600 px-6 py-3 font-medium whitespace-nowrap'
                        : 'text-gray-500 hover:text-gray-700 px-6 py-3 whitespace-nowrap'">
                      {{ system.name }}
                      @if (system.is_default) {
                        <span class="ml-1 text-xs text-gray-400">(default)</span>
                      }
                    </button>
                  }
                </nav>
              </div>

              <!-- Leaderboard content -->
              @if (selectedEloSystem()) {
                <div class="p-4 border-b border-gray-200 bg-gray-50">
                  <div class="flex items-center justify-between">
                    <div>
                      <h3 class="font-semibold text-gray-900">{{ selectedEloSystem()!.name }}</h3>
                      @if (selectedEloSystem()!.description) {
                        <p class="text-gray-600 text-sm">{{ selectedEloSystem()!.description }}</p>
                      }
                    </div>
                    <div class="flex gap-4 text-sm text-gray-500">
                      <span>K-Factor: {{ selectedEloSystem()!.k_factor }}</span>
                      <span>Starting: {{ selectedEloSystem()!.starting_rating }}</span>
                    </div>
                  </div>
                </div>

                @if (leaderboard().length === 0) {
                  <div class="p-8 text-center">
                    <p class="text-gray-500">No rankings yet</p>
                    <p class="text-gray-400 text-sm mt-1">Rankings will appear after tournament matches are completed</p>
                  </div>
                } @else {
                  <table class="w-full">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16">Rank</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Player</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Rating</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">W / L</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Win %</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Peak</th>
                        <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Streak</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                      @for (rating of leaderboard(); track rating.id; let i = $index) {
                        <tr class="hover:bg-gray-50">
                          <td class="px-4 py-3">
                            @if (i === 0) {
                              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-yellow-100 text-yellow-700 font-bold">1</span>
                            } @else if (i === 1) {
                              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-700 font-bold">2</span>
                            } @else if (i === 2) {
                              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-orange-100 text-orange-700 font-bold">3</span>
                            } @else {
                              <span class="text-gray-500 pl-2">{{ i + 1 }}</span>
                            }
                          </td>
                          <td class="px-4 py-3">
                            <div class="flex items-center gap-3">
                              <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-medium text-sm">
                                {{ rating.member_name?.charAt(0)?.toUpperCase() || '?' }}
                              </div>
                              <span class="font-medium text-gray-900">{{ rating.member_name }}</span>
                            </div>
                          </td>
                          <td class="px-4 py-3 text-right">
                            <span class="font-bold text-lg text-gray-900">{{ rating.rating }}</span>
                          </td>
                          <td class="px-4 py-3 text-right text-sm">
                            <span class="text-green-600">{{ rating.games_won }}</span>
                            <span class="text-gray-400 mx-1">/</span>
                            <span class="text-red-500">{{ rating.games_played - rating.games_won }}</span>
                          </td>
                          <td class="px-4 py-3 text-right text-sm text-gray-600">
                            {{ getWinRate(rating) }}%
                          </td>
                          <td class="px-4 py-3 text-right text-sm text-gray-500">
                            {{ rating.highest_rating }}
                          </td>
                          <td class="px-4 py-3 text-right">
                            @if (rating.current_win_streak >= 3) {
                              <span class="inline-flex items-center gap-1 text-green-600 font-medium">
                                <span class="text-orange-500">&#128293;</span>{{ rating.current_win_streak }}W
                              </span>
                            } @else if (rating.current_win_streak > 0) {
                              <span class="text-green-600 font-medium">{{ rating.current_win_streak }}W</span>
                            } @else {
                              <span class="text-gray-400">-</span>
                            }
                          </td>
                        </tr>
                      }
                    </tbody>
                  </table>
                }
              }
            </div>
          }
        </div>
      }

      <!-- ELO Settings Tab (Admin only) -->
      @if (activeTab() === 'elo') {
        <div class="space-y-4">
          <!-- Loading state -->
          @if (loadingElo()) {
            <div class="bg-white rounded-lg shadow p-8 text-center">
              <p class="text-gray-500">Loading ELO systems...</p>
            </div>
          } @else {
            <!-- System selector and create button -->
            <div class="bg-white rounded-lg shadow p-4">
              <div class="flex justify-between items-center">
                <div class="flex items-center gap-4">
                  <label class="text-sm font-medium text-gray-700">Rating System:</label>
                  @if (eloSystems().length === 0) {
                    <span class="text-gray-500 text-sm">No rating systems created</span>
                  } @else {
                    <select
                      [value]="selectedEloSystem()?.id"
                      (change)="onSystemSelect($any($event.target).value)"
                      class="border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                      @for (system of eloSystems(); track system.id) {
                        <option [value]="system.id">
                          {{ system.name }}
                          @if (system.is_default) { (default) }
                        </option>
                      }
                    </select>
                  }
                </div>
                <button
                  (click)="toggleCreateEloForm()"
                  class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg transition-colors text-sm">
                  {{ showCreateEloForm() ? 'Cancel' : 'Create Rating System' }}
                </button>
              </div>

              <!-- Create ELO System Form -->
              @if (showCreateEloForm()) {
                <div class="mt-4 pt-4 border-t border-gray-200">
                  @if (createEloError()) {
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                      {{ createEloError() }}
                    </div>
                  }

                  <form (ngSubmit)="onCreateEloSystem()" class="space-y-6">
                    <!-- Basic Settings -->
                    <div>
                      <h4 class="text-sm font-medium text-gray-900 mb-3">Basic Settings</h4>
                      <div class="grid grid-cols-2 gap-4">
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
                          <input
                            type="text"
                            [(ngModel)]="newEloSystem.name"
                            name="name"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., 1v1 Ranked"
                            [disabled]="creatingElo()">
                          <p class="text-xs text-gray-500 mt-1">Display name for this rating system</p>
                        </div>
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                          <input
                            type="text"
                            [(ngModel)]="newEloSystem.description"
                            name="description"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Optional description"
                            [disabled]="creatingElo()">
                          <p class="text-xs text-gray-500 mt-1">Optional description for players</p>
                        </div>
                      </div>
                      <div class="mt-3">
                        <label class="flex items-center gap-2 cursor-pointer">
                          <input
                            type="checkbox"
                            [(ngModel)]="newEloSystem.is_default"
                            name="is_default"
                            class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <span class="text-sm text-gray-700">Set as default rating system</span>
                        </label>
                        <p class="text-xs text-gray-500 mt-1 ml-6">New tournaments will use this system by default</p>
                      </div>
                    </div>

                    <!-- Core ELO Settings -->
                    <div>
                      <h4 class="text-sm font-medium text-gray-900 mb-3">Core ELO Settings</h4>
                      <div class="grid grid-cols-3 gap-4">
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Starting Rating</label>
                          <input
                            type="number"
                            [(ngModel)]="newEloSystem.starting_rating"
                            name="starting_rating"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <p class="text-xs text-gray-500 mt-1">Initial rating for new players</p>
                        </div>
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">K-Factor</label>
                          <input
                            type="number"
                            [(ngModel)]="newEloSystem.k_factor"
                            name="k_factor"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <p class="text-xs text-gray-500 mt-1">Rating volatility (higher = faster changes)</p>
                        </div>
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Floor Rating</label>
                          <input
                            type="number"
                            [(ngModel)]="newEloSystem.floor_rating"
                            name="floor_rating"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <p class="text-xs text-gray-500 mt-1">Minimum rating a player can have</p>
                        </div>
                      </div>
                    </div>

                    <!-- Provisional Period -->
                    <div>
                      <h4 class="text-sm font-medium text-gray-900 mb-3">Provisional Period</h4>
                      <div class="grid grid-cols-2 gap-4">
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Provisional Games</label>
                          <input
                            type="number"
                            [(ngModel)]="newEloSystem.provisional_games"
                            name="provisional_games"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <p class="text-xs text-gray-500 mt-1">Number of games before using standard K-factor</p>
                        </div>
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Provisional K-Factor</label>
                          <input
                            type="number"
                            [(ngModel)]="newEloSystem.provisional_k_factor"
                            name="provisional_k_factor"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <p class="text-xs text-gray-500 mt-1">Higher K-factor for new players to reach true rating faster</p>
                        </div>
                      </div>
                    </div>

                    <!-- Win Streak Bonus -->
                    <div>
                      <h4 class="text-sm font-medium text-gray-900 mb-3">Win Streak Bonus</h4>
                      <div class="mb-3">
                        <label class="flex items-center gap-2 cursor-pointer">
                          <input
                            type="checkbox"
                            [(ngModel)]="newEloSystem.win_streak_enabled"
                            name="win_streak_enabled"
                            class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <span class="text-sm text-gray-700">Enable win streak bonuses</span>
                        </label>
                        <p class="text-xs text-gray-500 mt-1 ml-6">Award bonus points for consecutive wins</p>
                      </div>
                      @if (newEloSystem.win_streak_enabled) {
                        <div class="grid grid-cols-2 gap-4 ml-6">
                          <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Streak Threshold</label>
                            <input
                              type="number"
                              [(ngModel)]="newEloSystem.win_streak_threshold"
                              name="win_streak_threshold"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                              [disabled]="creatingElo()">
                            <p class="text-xs text-gray-500 mt-1">Consecutive wins needed to trigger bonus</p>
                          </div>
                          <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Streak Bonus</label>
                            <input
                              type="number"
                              [(ngModel)]="newEloSystem.win_streak_bonus"
                              name="win_streak_bonus"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                              [disabled]="creatingElo()">
                            <p class="text-xs text-gray-500 mt-1">Extra rating points per win on a streak</p>
                          </div>
                        </div>
                      }
                    </div>

                    <!-- Rating Decay -->
                    <div>
                      <h4 class="text-sm font-medium text-gray-900 mb-3">Rating Decay</h4>
                      <div class="mb-3">
                        <label class="flex items-center gap-2 cursor-pointer">
                          <input
                            type="checkbox"
                            [(ngModel)]="newEloSystem.decay_enabled"
                            name="decay_enabled"
                            class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                            [disabled]="creatingElo()">
                          <span class="text-sm text-gray-700">Enable rating decay</span>
                        </label>
                        <p class="text-xs text-gray-500 mt-1 ml-6">Reduce ratings for inactive players</p>
                      </div>
                      @if (newEloSystem.decay_enabled) {
                        <div class="grid grid-cols-3 gap-4 ml-6">
                          <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Decay Days</label>
                            <input
                              type="number"
                              [(ngModel)]="newEloSystem.decay_days"
                              name="decay_days"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                              [disabled]="creatingElo()">
                            <p class="text-xs text-gray-500 mt-1">Days of inactivity before decay starts</p>
                          </div>
                          <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Decay Amount</label>
                            <input
                              type="number"
                              [(ngModel)]="newEloSystem.decay_amount"
                              name="decay_amount"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                              [disabled]="creatingElo()">
                            <p class="text-xs text-gray-500 mt-1">Rating points lost per decay period</p>
                          </div>
                          <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Decay Floor</label>
                            <input
                              type="number"
                              [(ngModel)]="newEloSystem.decay_floor"
                              name="decay_floor"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                              [disabled]="creatingElo()">
                            <p class="text-xs text-gray-500 mt-1">Minimum rating protected from decay</p>
                          </div>
                        </div>
                      }
                    </div>

                    <div class="flex justify-end pt-2">
                      <button
                        type="submit"
                        class="bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg transition-colors disabled:opacity-50"
                        [disabled]="creatingElo()">
                        {{ creatingElo() ? 'Creating...' : 'Create Rating System' }}
                      </button>
                    </div>
                  </form>
                </div>
              }
            </div>

            <!-- Selected system info and delete -->
            @if (selectedEloSystem()) {
              <div class="bg-white rounded-lg shadow p-4">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="font-semibold text-gray-900">{{ selectedEloSystem()!.name }}</h3>
                    @if (selectedEloSystem()!.description) {
                      <p class="text-gray-600 text-sm mt-1">{{ selectedEloSystem()!.description }}</p>
                    }
                    <div class="flex flex-wrap gap-x-4 gap-y-1 mt-2 text-sm text-gray-500">
                      <span>Starting: {{ selectedEloSystem()!.starting_rating }}</span>
                      <span>K-Factor: {{ selectedEloSystem()!.k_factor }}</span>
                      <span>Floor: {{ selectedEloSystem()!.floor_rating }}</span>
                      <span>Provisional: {{ selectedEloSystem()!.provisional_games }} games @ K={{ selectedEloSystem()!.provisional_k_factor }}</span>
                      @if (selectedEloSystem()!.win_streak_enabled) {
                        <span>Win Streak: +{{ selectedEloSystem()!.win_streak_bonus }} after {{ selectedEloSystem()!.win_streak_threshold }} wins</span>
                      }
                      @if (selectedEloSystem()!.decay_enabled) {
                        <span>Decay: -{{ selectedEloSystem()!.decay_amount }} after {{ selectedEloSystem()!.decay_days }} days</span>
                      }
                    </div>
                  </div>
                  <button
                    (click)="deleteEloSystem(selectedEloSystem()!, $event)"
                    class="text-red-500 hover:text-red-700 text-sm font-medium">
                    Delete System
                  </button>
                </div>
              </div>
            }

            <!-- No systems message -->
            @if (eloSystems().length === 0 && !showCreateEloForm()) {
              <div class="bg-white rounded-lg shadow p-8 text-center">
                <p class="text-gray-500 mb-2">No rating systems configured</p>
                <p class="text-gray-400 text-sm">Create a rating system to start tracking ELO rankings</p>
              </div>
            }
          }
        </div>
      }
    }
  </div>
</div>
