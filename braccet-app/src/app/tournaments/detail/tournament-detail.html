<div class="min-h-[calc(100vh-4rem)] bg-gray-100 p-6 pb-12">
  <app-breadcrumb [items]="breadcrumbs" />

  <div class="max-w-6xl mx-auto">
    @if (loading()) {
      <div class="flex justify-center items-center py-12">
        <div class="text-gray-500">Loading tournament...</div>
      </div>
    } @else if (error()) {
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6 text-sm">
        {{ error() }}
      </div>
    } @else if (tournament()) {
      <!-- Header with title and status -->
      <div class="flex justify-between items-start mb-4">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">{{ tournament()!.name }}</h1>
          @if (tournament()!.game) {
            <p class="text-gray-600 mt-1">{{ tournament()!.game }}</p>
          }
        </div>
        <div class="flex items-center gap-3">
          <span [class]="'px-3 py-1 rounded-full text-sm font-medium ' + getStatusColor(tournament()!.status)">
            {{ getStatusLabel(tournament()!.status) }}
          </span>
          @if (canStartTournament()) {
            <button
              (click)="startTournament()"
              [disabled]="startingTournament()"
              class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 text-sm font-medium">
              @if (startingTournament()) {
                Starting...
              } @else {
                Start Tournament
              }
            </button>
          }
        </div>
      </div>

      <!-- Condensed Tournament Info Card -->
      <div class="bg-white rounded-lg shadow border border-gray-200 p-4 mb-6">
        <div class="flex flex-wrap items-center gap-x-8 gap-y-2 text-sm">
          <div class="flex items-center gap-2">
            <span class="text-gray-500">Format:</span>
            <span class="font-medium text-gray-900">
              {{ tournament()!.format === 'single_elimination' ? 'Single Elimination' : 'Double Elimination' }}
            </span>
          </div>

          <div class="flex items-center gap-2">
            <span class="text-gray-500">Max Participants:</span>
            <span class="font-medium text-gray-900">
              {{ tournament()!.max_participants || 'Unlimited' }}
            </span>
          </div>

          @if (tournament()!.starts_at) {
            <div class="flex items-center gap-2">
              <span class="text-gray-500">
                Start Date
                @if (tournament()!.starts_at_tentative) {
                  <span class="text-yellow-600">(Tentative)</span>
                }:
              </span>
              <span class="font-medium text-gray-900">
                {{ tournament()!.starts_at | date:'medium' }}
              </span>
            </div>
          }

          <div class="flex items-center gap-2">
            <span class="text-gray-500">Registration:</span>
            <span [class]="'font-medium ' + (tournament()!.registration_open ? 'text-green-600' : 'text-gray-900')">
              {{ tournament()!.registration_open ? 'Open' : 'Closed' }}
            </span>
          </div>
        </div>

        @if (tournament()!.description) {
          <p class="mt-3 pt-3 border-t border-gray-200 text-sm text-gray-700">{{ tournament()!.description }}</p>
        }
      </div>

      <!-- Side Panel with vertical tabs -->
      <app-side-panel
        [tournament]="tournament()!"
        [participants]="participants()"
        [isOrganizer]="isOrganizer()"
        [isLoggedIn]="isLoggedIn()"
        [currentUser]="authService.user()"
        (participantAdded)="onParticipantAdded($event)"
        (participantRemoved)="onParticipantRemoved($event)"
        (seedingChanged)="onSeedingChanged($event)"
        (selfRegistered)="onSelfRegistered($event)"
        (left)="onLeft($event)"
        (tournamentUpdated)="onTournamentUpdated($event)"
      />
    }
  </div>
</div>
